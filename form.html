<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>เพิ่มข้อมูลร้านค้า</title>
<link rel="stylesheet" href="style.css">

<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

</head>
<body>

<h2>เพิ่มข้อมูลร้านค้า</h2>

<label>ชื่อร้าน</label>
<input id="name">

<label>ประเภทร้าน</label>
<select id="type">
  <option>ร้านอาหารเครื่องดื่ม</option>
  <option>ร้านค้าปลีก</option>
  <option>ร้านบริการ</option>
</select>

<label>คำอธิบายร้าน</label>
<textarea id="desc"></textarea>

<p>เลื่อนหมุดเพื่อกำหนดตำแหน่งร้าน</p>
<div id="map" style="height: 50vh;"></div>

<button id="saveBtn">บันทึก</button>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyDGYuI3yxJbUTc6T_0pm6WiEKZul11tXS0",
  authDomain: "suchartwork-1487382986748.firebaseapp.com",
  databaseURL: "https://suchartwork-1487382986748.firebaseio.com",
  projectId: "suchartwork-1487382986748",
  storageBucket: "suchartwork-1487382986748.firebasestorage.app",
  messagingSenderId: "353884592527",
  appId: "1:353884592527:web:4233ac2ae7eef075eb13fa"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

let lat = 16.4419, lng = 102.835;
const map = L.map("map").setView([lat, lng], 14);
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);
const marker = L.marker([lat, lng], { draggable: true }).addTo(map);
marker.on("dragend", e => {
  lat = e.target.getLatLng().lat;
  lng = e.target.getLatLng().lng;
});

document.getElementById("saveBtn").onclick = () => {
  push(ref(db, "stores"), {
    name: name.value,
    type: type.value,
    desc: desc.value,
    lat: lat,
    lng: lng
  });
  alert("บันทึกสำเร็จ");
};
</script>

</body>
</html>
